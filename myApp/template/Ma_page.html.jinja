{% include "info.html.jinja" %}
{% include "head.html.jinja" %}
{% include "header.html.jinja" %}
{% include "menu.html.jinja" %}


<div class="container my-5">
  <h1 class="text-center mb-5">Mon profil</h1>

  {# ─── Messages flash ─────────────────────────────── #}
  {% if message %}
    <div class="alert alert-{{ category }} text-center">
      {{ message }}
    </div>
  {% endif %}

  <div class="row g-5 justify-content-center">

    <!-- Colonne gauche : Formulaires -->
    <div class="col-lg-6">
      <!-- Formulaire de mise à jour des infos -->
      <div class="card mb-4 shadow-sm">
        <div class="card-header bg-white border-bottom">
          <h5>Modifier mes informations</h5>
        </div>
        <div class="card-body">
          <form method="post">
            <div class="mb-3">
              <label for="username" class="form-label">Identifiant</label>
              <input type="text" class="form-control" id="username" name="username"
                     value="{{ user.username }}" required>
            </div>

            <div class="row mb-3">
              <div class="col">
                <label for="nom" class="form-label">Nom</label>
                <input type="text" class="form-control" id="nom" name="nom"
                       value="{{ user.nom }}" required>
              </div>
              <div class="col">
                <label for="prenom" class="form-label">Prénom</label>
                <input type="text" class="form-control" id="prenom" name="prenom"
                       value="{{ user.prenom }}" required>
              </div>
            </div>

            <div class="mb-4">
              <label for="email" class="form-label">E-mail</label>
              <input type="email" class="form-control" id="email" name="email"
                     value="{{ user.email }}" required>
            </div>

            <div class="d-grid">
              <button type="submit" name="update_info" class="button large fit">
                Enregistrer les modifications
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Formulaire de changement de mot de passe -->
      <div class="card shadow-sm">
        <div class="card-header bg-white border-bottom">
          <h5> Modifier mon mot de passe</h5>
        </div>
        <div class="card-body">
          <form method="post">
            <div class="mb-3">
              <label for="old_password" class="form-label">Mot de passe actuel</label>
              <input type="password" class="form-control" id="old_password"
                     name="old_password" required>
            </div>

            <div class="mb-3">
              <label for="new_password" class="form-label">Nouveau mot de passe</label>
              <input type="password" class="form-control" id="new_password"
                     name="new_password" required>
            </div>

            <div class="mb-4">
              <label for="confirm_password" class="form-label">Confirmer le nouveau mot de passe</label>
              <input type="password" class="form-control" id="confirm_password"
                     name="confirm_password" required>
            </div>

            <div class="d-grid">
              <button type="submit" name="update_pass" class="button large fit">
                Changer le mot de passe
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Colonne droite : État du compte -->
    <div class="col-lg-5">
      <div class="card shadow-sm">
  <div class="card-header" style="background-color: #fdf7f0; color: #5a3825;">
    <h5 class="mb-0">État actuel du compte</h5>
  </div>
  <div class="card-body">
    <ul class="list-unstyled mb-4">
      <li><strong>Identifiant :</strong> {{ user.username }}</li>
      <li><strong>Nom :</strong> {{ user.nom }}</li>
      <li><strong>Prénom :</strong> {{ user.prenom }}</li>
      <li><strong>E-mail :</strong> {{ user.email }}</li>
    </ul>

    <div class="mt-4">
      <h6 class="text-muted mb-2">Mes préférences thématiques</h6>
<ul class="list-group list-group-flush">
  {% for theme in themes %}
    {% if theme.theme_id in user_theme_ids %}
      <li class="list-group-item" style="background-color: #fffdf9;">
        {{ theme.nom }}
      </li>
    {% endif %}
  {% endfor %}
</ul>

    </div>
  </div>
</div>
    </div>

  </div>
</div>

{% include "script.html.jinja" %}
{% include "footer.html.jinja" %}